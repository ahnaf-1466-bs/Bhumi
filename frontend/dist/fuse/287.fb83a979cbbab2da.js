"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[287],{5287:(A,f,n)=>{n.r(f),n.d(f,{VideoPdfActivityModule:()=>G});var m=n(6895),t=n(4650),p=n(8255),u=n(9197),y=n(7477),v=n(4512),b=n(51),I=n(8951),_=n(780),D=n(658),x=n(3416),T=n(2340),V=n(3900),w=n(9646),C=n(529);let P=(()=>{class e{constructor(i){this.http=i}getVideoPlusDetails(i,o){const s=localStorage.getItem("auth-token");let a=new FormData;return a.append("wstoken",s),a.append("wsfunction","mod_videoplus_get_details"),a.append("moodlewsrestformat","json"),a.append("courseid",i),a.append("cmid",o),this.http.post(`${T.N.baseURL}/webservice/rest/server.php`,a).pipe((0,V.w)(l=>(0,w.of)(l)))}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(C.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=n(7392),Z=n(1537);const L=["myVideo"];function N(e,r){1&e&&(t.TgZ(0,"div",4),t._UZ(1,"div",5),t.qZA())}function S(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div",6)(1,"div")(2,"h1",7),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",8)(6,"button",9),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.goToCourse())}),t._uU(7),t.ALo(8,"translate"),t.qZA()()()()}2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,2,"YOU ARE NOT ENROLLED IN THIS COURSE")," "),t.xp6(4),t.hij(" ",t.lcZ(8,4,"Course Details")," "))}function F(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.goPrevActivity())}),t._UZ(1,"mat-icon",31),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&e&&(t.xp6(1),t.Q6J("svgIcon","mat_solid:keyboard_arrow_left"),t.xp6(2),t.Oqu(t.lcZ(4,2,"Previous")))}function J(e,r){1&e&&t._UZ(0,"button")}function U(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.goNextActivity())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"mat-icon",31),t.qZA()}2&e&&(t.xp6(2),t.hij("",t.lcZ(3,2,"Next")," "),t.xp6(2),t.Q6J("svgIcon","mat_solid:keyboard_arrow_right"))}function M(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.getCertificate())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Download Certificate")," "))}function Y(e,r){1&e&&(t.TgZ(0,"button",33),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.Q6J("disabled",!0),t.xp6(1),t.hij(" ",t.lcZ(2,2,"Download Certificate")," "))}function E(e,r){1&e&&t._UZ(0,"mat-icon",31),2&e&&t.Q6J("svgIcon","mat_solid:keyboard_arrow_down")}function k(e,r){1&e&&t._UZ(0,"mat-icon",31),2&e&&t.Q6J("svgIcon","mat_solid:keyboard_arrow_up")}function z(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"span",34),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"a",35),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.downloadPdfFile())}),t.TgZ(5,"span"),t._uU(6,"1. "),t.qZA(),t.TgZ(7,"span",36),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"mat-icon",37),t.qZA()()}2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,3,"Files")),t.xp6(6),t.Oqu(t.lcZ(9,5,"Course Material Title")),t.xp6(2),t.Q6J("svgIcon","mat_solid:insert_drive_file"))}const H=function(e){return{hidden:e}};function q(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"video",13,14),t.NdJ("loadedmetadata",function(s){t.CHM(i);const a=t.oxw();return t.KtG(a.onVideoMetadataLoaded(s))})("loadstart",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.loadPreviousTime())})("timeupdate",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.saveCurrentTime())}),t._UZ(5,"source",15),t.qZA()(),t.TgZ(6,"div",16)(7,"div",17),t.YNc(8,F,5,4,"button",18),t.YNc(9,J,1,0,"button",19),t.YNc(10,U,5,4,"button",20),t.YNc(11,M,3,3,"button",21),t.YNc(12,Y,3,4,"button",22),t.qZA()(),t.TgZ(13,"div",23)(14,"p",24),t._uU(15),t.qZA()(),t.TgZ(16,"div",25)(17,"div",26)(18,"button",27),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.toggleVideoDescription())}),t.TgZ(19,"span"),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.YNc(22,E,1,1,"mat-icon",28),t.YNc(23,k,1,1,"mat-icon",28),t.qZA(),t._UZ(24,"p",29),t.ALo(25,"sanitizeHtml"),t.qZA(),t.YNc(26,z,11,7,"div",19),t.qZA()()()}if(2&e){const i=t.oxw();t.xp6(5),t.Q6J("src",i.video_src,t.LSH),t.xp6(3),t.Q6J("ngIf",-1!=i.prevActivityID&&"customcert"!=i.prevActivityType),t.xp6(1),t.Q6J("ngIf",-1==i.prevActivityID),t.xp6(1),t.Q6J("ngIf",-1!=i.nextActivityID&&"customcert"!=i.nextActivityType&&1==i.activityDone),t.xp6(1),t.Q6J("ngIf",-1!=i.nextActivityID&&"customcert"==i.nextActivityType&&i.certificateAvailable),t.xp6(1),t.Q6J("ngIf",-1!=i.nextActivityID&&"customcert"==i.nextActivityType&&!i.certificateAvailable),t.xp6(3),t.hij(" ",i.videoName," "),t.xp6(5),t.Oqu(t.lcZ(21,13,"Video Description")),t.xp6(2),t.Q6J("ngIf",!i.showVideoDesc),t.xp6(1),t.Q6J("ngIf",i.showVideoDesc),t.xp6(1),t.Q6J("ngClass",t.VKq(17,H,!i.showVideoDesc))("innerHTML",t.lcZ(25,15,i.videoDesc),t.oJD),t.xp6(2),t.Q6J("ngIf",i.pdfURL)}}let Q=(()=>{class e{constructor(i,o,s,a,l,h,d,c,K,$,B){this.domSanitizer=i,this.route=o,this.router=s,this.getCertificateApi=a,this.autoDoneApi=l,this.getActivityStatus=h,this.authService=d,this.activityApi=c,this.activityCompletion=K,this.translateService=$,this.videoPlusService=B,this.certificateAvailable=!1,this.cert_url="",this.loading=!0,this.prevActivityID=-1,this.nextActivityID=-1,this.prevActivityType="",this.nextActivityType="",this.prevActivityFormat="",this.nextActivityFormat="",this.activityDone=!1,this.enrolled=!0,this.currentVideoTime=0,this.doneBtnDisabled=!0,this.videoFinished=!1,this.activityInfo={},this.showVideoDesc=!1}ngOnInit(){this.route.queryParams.subscribe(i=>{this.enrolled=!0,this.videoFound=!1,this.activityDone=!1,this.currentActivity={},this.topicId=i.topic,this.activityID=i.activity,this.video_src="",this.prevActivityID=-1,this.nextActivityID=-1,this.loading=!0,this.courseID=i.course,this.userID=localStorage.getItem("user-id"),this.wsToken=localStorage.getItem("auth-token"),this.saveCurrentActivity(this.userID,this.courseID,this.activityID,this.topicId),this.getActivityStatus.getActivityStatus(this.courseID,this.userID).subscribe(o=>{if(o.exception||o.errorcode)return this.enrolled=!1,this.loading=!1,this.videoFound=!1,this.authService.signOut(),void this.router.navigate(["login"]);let s=o.statuses;this.enrolled=!1;for(let a of s)a.cmid==this.activityID&&(this.activityInfo=a,this.enrolled=!0,1==a.isautomatic?(this.isAutomatic=!0,1==a.state?(this.activityDone=!0,this.doneBtnDisabled=!0,this.testCertificate(),this.activityCompletion.updateActivityStatus(Number(this.activityID))):this.activityDone=!1):1==a.state?(this.activityDone=!0,this.doneBtnDisabled=!1,this.testCertificate(),this.activityCompletion.updateActivityStatus(Number(this.activityID))):this.activityDone=!1);this.loading=!1}),this.activityApi.getActivities(this.courseID).subscribe(o=>{const s=o.slice(1),a=s.find(h=>h.id==this.topicId),l=s.findIndex(h=>h.id==this.topicId);this.activityList=a.modules,this.activityList&&this.activityList.forEach((h,d)=>{if(h.id==this.activityID){if(this.loading=!1,this.videoFound=!0,"bn"===this.translateService.getDefaultLang()?this.activityApi.getBengaliDetailsActivity(h.id).subscribe(c=>{this.videoName=c.results[0].category_details[0].field_value,this.videoDesc=c.results[0].category_details[1].field_value}):this.videoName=h.name,this.videoPlusService.getVideoPlusDetails(this.courseID,this.activityID).subscribe(c=>{this.fileURL=c?.details[0].videourl,this.pdfURL=c?.details[0].pdfurl,"bn"!==this.translateService.getDefaultLang()&&(this.videoDesc=c?.details[0].intro),this.video_src=this.domSanitizer.bypassSecurityTrustResourceUrl(this.fileURL),this.myVideo&&this.myVideo.nativeElement.load()}),d>0)this.activityList[d-1].id&&(this.prevActivityID=this.activityList[d-1].id,this.prevInstanceID=this.activityList[d-1].instance,this.prevActivityType=this.activityList[d-1].modname,"resource"==this.prevActivityType&&(this.prevActivityFormat=this.activityList[d-1].contentsinfo.mimetypes));else if(l-1>=0&&s[l-1].modules.length>0){const c=s[l-1].modules;this.prevTopicId=s[l-1].id,this.prevActivityID=c[c.length-1].id,this.prevInstanceID=c[c.length-1].instance,this.prevActivityType=c[c.length-1].modname,"resource"==this.prevActivityType&&(this.prevActivityFormat=c[c.length-1].contentsinfo.mimetypes)}if(d+1<this.activityList.length)this.activityList[d+1].id&&(this.nextActivityID=this.activityList[d+1].id,this.instanceID=this.activityList[d+1].instance,this.nextActivityType=this.activityList[d+1].modname,"resource"==this.nextActivityType&&(this.nextActivityFormat=this.activityList[d+1].contentsinfo.mimetypes));else if(l+1<s.length&&s[l+1].modules.length>0){const c=s[l+1].modules;this.nextTopicId=s[l+1].id,this.nextActivityID=c[0].id,this.instanceID=c[0].instance,this.nextActivityType=c[0].modname,"resource"==this.nextActivityType&&(this.nextActivityFormat=c[0].contentsinfo.mimetypes)}}})})})}ngAfterViewInit(){this.timer=setInterval(()=>{this.myVideo&&this.myVideo.nativeElement&&this.myVideo.nativeElement.currentTime&&(this.currentVideoTime=this.myVideo.nativeElement.currentTime,this.currentVideoTime>=this.marginalVideoTime&&(this.activityDone=!0,this.autoDone(),this.activityCompletion.updateActivityStatus(Number(this.activityID))))},1e3)}ngOnDestroy(){clearInterval(this.timer)}autoDone(){this.autoDoneApi.autoDoneVideoPlus(this.activityInfo.instance).subscribe(i=>{this.activityDone=!0,this.testCertificate(),this.doneBtnDisabled=!0,this.activityCompletion.updateActivityStatus(Number(this.activityID))})}onVideoMetadataLoaded(i){this.videoDuration=this.myVideo.nativeElement.duration,this.marginalVideoTime=75*this.videoDuration/100}getCertificate(){window.open(this.cert_url,"_blank")}testCertificate(){this.getCertificateApi.getCertificate(this.courseID,this.userID).subscribe(i=>{i.url?(this.certificateAvailable=!0,this.cert_url=i.url):this.certificateAvailable=!1})}onLoadMetadata(i){this.videoDuration=this.myVideo.nativeElement.duration}goNextActivity(){-1===this.activityList.findIndex(i=>i.id==this.nextActivityID)&&(this.topicId=this.nextTopicId),"quiz"==this.nextActivityType?this.router.navigate([`course-activity/${this.courseID}/quiz`],{queryParams:{id:this.instanceID,course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"zoom"==this.nextActivityType?this.router.navigate([`course-activity/${this.courseID}/meeting`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"videoplus"===this.nextActivityType?this.router.navigate([`course-activity/${this.courseID}/video-pdf`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"coursefeedback"==this.nextActivityType?this.router.navigate([`course-activity/${this.courseID}/feedback`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"application/pdf"==this.nextActivityFormat?this.router.navigate([`course-activity/${this.courseID}/pdf`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):("video/mp4"==this.nextActivityFormat||"video/webm"==this.nextActivityFormat||"video/mov"==this.nextActivityFormat)&&this.router.navigate([`course-activity/${this.courseID}/video`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}})}goPrevActivity(){-1===this.activityList.findIndex(i=>i.id==this.prevActivityID)&&(this.topicId=this.prevTopicId),"quiz"==this.prevActivityType?this.router.navigate([`course-activity/${this.courseID}/quiz`],{queryParams:{id:this.prevInstanceID,course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):"zoom"==this.prevActivityType?this.router.navigate([`course-activity/${this.courseID}/meeting`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):"videoplus"===this.prevActivityType?this.router.navigate([`course-activity/${this.courseID}/video-pdf`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):"application/pdf"==this.prevActivityFormat?this.router.navigate([`course-activity/${this.courseID}/pdf`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):("video/mp4"==this.prevActivityFormat||"video/webm"==this.prevActivityFormat||"video/mov"==this.prevActivityFormat)&&this.router.navigate([`course-activity/${this.courseID}/video`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}})}saveCurrentTime(){this.route.queryParams.subscribe(i=>{localStorage.setItem(JSON.stringify(i),this.myVideo.nativeElement.currentTime)})}loadPreviousTime(){this.route.queryParams.subscribe(i=>{const o=Number(localStorage.getItem(JSON.stringify(i)));this.myVideo&&(this.myVideo.nativeElement.currentTime=o)})}toggleVideoDescription(){this.showVideoDesc=!this.showVideoDesc}downloadPdfFile(){window.open(this.pdfURL,"_blank")}saveCurrentActivity(i,o,s,a){const l={type:"video-pdf",activityId:s,topicId:a};localStorage.setItem(JSON.stringify({userId:i,courseId:o}),JSON.stringify(l))}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(p.H7),t.Y36(u.gz),t.Y36(u.F0),t.Y36(y.G),t.Y36(v.F),t.Y36(b.o),t.Y36(I.e),t.Y36(_.I),t.Y36(D.B),t.Y36(x.sK),t.Y36(P))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-video-pdf-activity"]],viewQuery:function(i,o){if(1&i&&t.Gf(L,5),2&i){let s;t.iGM(s=t.CRH())&&(o.myVideo=s.first)}},decls:4,vars:3,consts:[[1,"infxs:min-h-[400px]","md:min-h-screen"],["class","min-h-screen flex justify-center items-center",4,"ngIf"],["class","h-screen flex justify-center items-center",4,"ngIf"],["class","video-container lg:max-w-4xl xl:max-w-7xl pb-5 infxs:pt-5 md:pt-0 mx-auto",4,"ngIf"],[1,"min-h-screen","flex","justify-center","items-center"],[1,"loader"],[1,"h-screen","flex","justify-center","items-center"],[1,"text-center","text-vumi-orange","text-2xl","font-bold","lg:text-4xl"],[1,"flex","justify-center","mt-7"],["type","button",1,"button-vumi","infxs:text-base","sm:text-lg","infxs:w-30","infxs:h-8","sm:w-[140px]","sm:h-[38px]","text-white","bg-blue-700","hover:bg-blue-800","focus:outline-none","focus:ring-4","focus:ring-blue-300","font-medium","text-center","mr-2","mb-2","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800",3,"click"],[1,"video-container","lg:max-w-4xl","xl:max-w-7xl","pb-5","infxs:pt-5","md:pt-0","mx-auto"],[1,"max-w-[1000px]","mx-auto"],["id","video",1,"relative"],["controls","","controlsList","fullscreen nodownload noremoteplayback noplaybackrate foobar","preload","metadata","width","100%","data-setup",'{ "aspectRatio":"640:267", "playbackRates": [1, 1.5, 2] }',1,"mx-auto","mb-6","rounded",3,"loadedmetadata","loadstart","timeupdate"],["myVideo",""],["type","video/mp4",3,"src"],[1,"lg:max-w-4xl","xl:max-w-7xl","mb-6","mx-auto"],[1,"infxs:mx-0","xs:mx-15","sm:mx-18","md:mx-20","lg:mx-30","xl:mx-40","gap-2","flex","flex-row","justify-between","lg:mt-4","infxs:mt-4","lg:mb-4","infxs:mb-4"],["class","button-vumi infxs:text-base sm:text-lg infxs:w-30 infxs:h-8 sm:w-[140px] sm:h-[38px] bg-vumi-orange text-white  font-bold  outline-none focus:outline-none mb-1 ease-linear transition-all duration-150","type","button",3,"click",4,"ngIf"],[4,"ngIf"],["class","button-vumi infxs:text-base sm:text-lg infxs:w-30 infxs:h-8 sm:w-[140px] sm:h-[38px] bg-vumi-orange text-white font-bold  outline-none focus:outline-none mb-1 ease-linear transition-all duration-150","type","button",3,"click",4,"ngIf"],["class","infxs:px-2 button-vumi infxs:text-base sm:text-lg infxs:w-30 infxs:h-8 sm:w-[140px] sm:h-[38px] border border-vumi-blue bg-vumi-blue text-white font-bold outline-none focus:outline-none  mb-1 ease-linear transition-all duration-150","type","button",3,"click",4,"ngIf"],["class","infxs:px-2 text-base border border-gray-300 bg-gray-300 text-white font-bold outline-none focus:outline-none mb-1 ease-linear transition-all duration-150","type","button",3,"disabled",4,"ngIf"],[1,"mb-4"],[1,"text-left","text-[#121212]","font-semibold","lg:text-4xl","sm:text-5xl","infxs:text-3xl"],[1,"mb-4","flex","gap-y-4","justify-between","infxs:flex-col","md:flex-row"],[1,"flex","flex-col","gap-y-2"],["type","button",1,"w-[182px]","infxs:h-8","sm:h-[38px]","button-vumi","infxs:text-base","sm:text-lg","bg-vumi-orange","text-white","font-bold","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",3,"click"],["class","text-white icon-size-7","aria-hidden","false","aria-label","previous activity icon",3,"svgIcon",4,"ngIf"],[1,"infxs:max-w-full","md:max-w-[487px]","text-justify","infxs:text-base","sm:text-lg",3,"ngClass","innerHTML"],["type","button",1,"button-vumi","infxs:text-base","sm:text-lg","infxs:w-30","infxs:h-8","sm:w-[140px]","sm:h-[38px]","bg-vumi-orange","text-white","font-bold","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",3,"click"],["aria-hidden","false","aria-label","previous activity icon",1,"text-white","icon-size-7",3,"svgIcon"],["type","button",1,"infxs:px-2","button-vumi","infxs:text-base","sm:text-lg","infxs:w-30","infxs:h-8","sm:w-[140px]","sm:h-[38px]","border","border-vumi-blue","bg-vumi-blue","text-white","font-bold","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",3,"click"],["type","button",1,"infxs:px-2","text-base","border","border-gray-300","bg-gray-300","text-white","font-bold","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",3,"disabled"],[1,"underline","decoration-vumi-orange","font-bold","text-lg"],[1,"text-lg","flex","items-center","gap-2","mt-3","cursor-pointer",3,"click"],[1,"underline"],["aria-hidden","false","aria-label","pdf file",1,"text-vumi-orange","icon-size-7",3,"svgIcon"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0),t.YNc(1,N,2,0,"div",1),t.YNc(2,S,9,6,"div",2),t.YNc(3,q,27,19,"div",3),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.enrolled),t.xp6(1),t.Q6J("ngIf",o.videoFound&&o.enrolled))},dependencies:[m.mk,m.O5,g.Hw,x.X$,Z.A],encapsulation:2}),e})();var O=n(266),j=n(1056);const R=[{path:"",component:Q}];let G=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.ez,u.Bz.forChild(R),g.Ps,O.AV,j.m]}),e})()},1537:(A,f,n)=>{n.d(f,{A:()=>p});var m=n(4650),t=n(8255);let p=(()=>{class u{constructor(v){this._sanitizer=v}transform(v){return v?.length>0?this._sanitizer.bypassSecurityTrustHtml(v):v}}return u.\u0275fac=function(v){return new(v||u)(m.Y36(t.H7,16))},u.\u0275pipe=m.Yjl({name:"sanitizeHtml",type:u,pure:!0}),u})()}}]);