"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[586],{2586:(Q,h,n)=>{n.r(h),n.d(h,{PdfActivityModule:()=>M});var d=n(6895),p=n(9197),m=n(1056),t=n(4650),x=n(8255),g=n(7477),b=n(2340),A=n(3900),I=n(9646),D=n(529);let _=(()=>{class e{constructor(i,o){this.http=i,this.router=o}updateActivityStatus(i){let o=localStorage.getItem("auth-token"),s=new FormData;return s.append("wsfunction","core_completion_update_activity_completion_status_manually"),s.append("wstoken",o),s.append("moodlewsrestformat","json"),s.append("cmid",i.cmid),s.append("completed",i.completed),this.http.post(`${b.N.baseURL}/webservice/rest/server.php`,s).pipe((0,A.w)(u=>(0,I.of)(u)))}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(D.eN),t.LFG(p.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var T=n(51),w=n(8951),C=n(780),P=n(658),f=n(3416),y=n(7392);function Z(e,r){1&e&&(t.TgZ(0,"div",4),t._UZ(1,"div",5),t.qZA())}function L(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div",6)(1,"div")(2,"h1",7),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",8)(6,"button",9),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.goToCourse())}),t._uU(7),t.ALo(8,"translate"),t.qZA()()()()}2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,2,"YOU ARE NOT ENROLLED IN THIS COURSE")," "),t.xp6(4),t.hij(" ",t.lcZ(8,4,"Course Details")," "))}function F(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.goPrevActivity())}),t._UZ(1,"mat-icon",25),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&e&&(t.xp6(1),t.Q6J("svgIcon","mat_solid:keyboard_arrow_left"),t.xp6(2),t.Oqu(t.lcZ(4,2,"Previous")))}function S(e,r){1&e&&t._UZ(0,"button")}function N(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.goNextActivity())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"mat-icon",25),t.qZA()}2&e&&(t.xp6(2),t.hij("",t.lcZ(3,2,"Next")," "),t.xp6(2),t.Q6J("svgIcon","mat_solid:keyboard_arrow_right"))}function k(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.toggleActivityStatus())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Mark as Done")," "))}function U(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.getCertificate())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Download Certificate")," "))}function z(e,r){1&e&&(t.TgZ(0,"button",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.Q6J("disabled",!0),t.xp6(1),t.hij(" ",t.lcZ(2,2,"Download Certificate")," "))}function J(e,r){if(1&e&&(t.TgZ(0,"div",10)(1,"div",11)(2,"div",12),t._UZ(3,"iframe",13),t.qZA(),t.TgZ(4,"div",14)(5,"div",15),t.YNc(6,F,5,4,"button",16),t.YNc(7,S,1,0,"button",17),t.YNc(8,N,5,4,"button",18),t.YNc(9,k,3,3,"button",19),t.YNc(10,U,3,3,"button",20),t.YNc(11,z,3,4,"button",21),t.qZA()(),t.TgZ(12,"div",22)(13,"p",23),t._uU(14),t.qZA()()()()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("src",i.pdf_src,t.uOi),t.xp6(3),t.Q6J("ngIf",-1!=i.prevActivityID&&"customcert"!=i.prevActivityType),t.xp6(1),t.Q6J("ngIf",-1==i.prevActivityID),t.xp6(1),t.Q6J("ngIf",-1!=i.nextActivityID&&"customcert"!=i.nextActivityType&&i.activityDone),t.xp6(1),t.Q6J("ngIf",!i.activityDone),t.xp6(1),t.Q6J("ngIf",-1!=i.nextActivityID&&"customcert"==i.nextActivityType&&i.certificateAvailable),t.xp6(1),t.Q6J("ngIf",-1!=i.nextActivityID&&"customcert"==i.nextActivityType&&!i.certificateAvailable),t.xp6(3),t.hij(" ",i.pdfName," ")}}const Y=[{path:"",component:(()=>{class e{constructor(i,o,s,u,l,v,a,c,j,O){this.sanitize=i,this.route=o,this._router=s,this.getCertificateApi=u,this.updateActivityStatus=l,this.getActivityStatus=v,this._authService=a,this.activityApi=c,this.activityCompletion=j,this.translateService=O,this.enrolled=!0,this.certificateAvailable=!1,this.loading=!0,this.prevActivityID=-1,this.nextActivityID=-1,this.cert_url="",this.prevActivityType="",this.nextActivityType="",this.prevActivityFormat="",this.nextActivityFormat="",this.activityDone=!1,this.doneBtnDisabled=!1}ngOnInit(){this.route.queryParams.subscribe(i=>{this.topicId=i.topic,this.activityDone=!1,this.enrolled=!0,this.currentActivity={},this.prevActivityID=-1,this.nextActivityID=-1,this.pdfFound=!1,this.loading=!0,this.activityID=i.activity,this.courseID=i.course,this.userID=localStorage.getItem("user-id"),this.saveCurrentActivity(this.userID,this.courseID,this.activityID,this.topicId),this.getActivityStatus.getActivityStatus(this.courseID,this.userID).subscribe(o=>{if(o.exception||o.errorcode)return this.enrolled=!1,this.loading=!1,this.pdfFound=!1,this._authService.signOut(),void this._router.navigate(["login"]);let s=o.statuses;this.enrolled=!1;for(let u of s)u.cmid==this.activityID&&(this.enrolled=!0,0==u.state?this.activityDone=!1:(this.activityDone=!0,this.testCertificate(),this.activityCompletion.updateActivityStatus(Number(this.activityID))));this.loading=!1}),this.wsToken=localStorage.getItem("auth-token"),this.activityApi.getActivities(this.courseID).subscribe(o=>{const s=o.slice(1),u=s.find(v=>v.id==this.topicId),l=s.findIndex(v=>v.id==this.topicId);this.activityList=u.modules,this.activityList.forEach((v,a)=>{if(v.id==this.activityID){if(this.loading=!1,this.pdfFound=!0,"bn"===this.translateService.getDefaultLang()?this.activityApi.getBengaliDetailsActivity(v.id).subscribe(c=>{this.pdfName=c.results[0].category_details[0].field_value}):this.pdfName=v.name,this.fileURL=v.contents[0].fileurl,this.fileURL=this.fileURL+"&token="+this.wsToken,this.pdf_src=this.sanitize.bypassSecurityTrustResourceUrl(this.fileURL),a>0)this.activityList[a-1].id&&(this.prevActivityID=this.activityList[a-1].id,this.prevInstanceID=this.activityList[a-1].instance,this.prevActivityType=this.activityList[a-1].modname,"resource"==this.prevActivityType&&(this.prevActivityFormat=this.activityList[a-1].contentsinfo.mimetypes));else if(l-1>=0&&s[l-1].modules.length>0){const c=s[l-1].modules;this.prevTopicId=s[l-1].id,this.prevActivityID=c[c.length-1].id,this.prevInstanceID=c[c.length-1].instance,this.prevActivityType=c[c.length-1].modname,"resource"==this.prevActivityType&&(this.prevActivityFormat=c[c.length-1].contentsinfo.mimetypes)}if(a+1<this.activityList.length)this.activityList[a+1].id&&(this.nextActivityID=this.activityList[a+1].id,this.instanceID=this.activityList[a+1].instance,this.nextActivityType=this.activityList[a+1].modname,"resource"==this.nextActivityType&&(this.nextActivityFormat=this.activityList[a+1].contentsinfo.mimetypes));else if(l+1<s.length&&s[l+1].modules.length>0){const c=s[l+1].modules;this.nextTopicId=s[l+1].id,this.nextActivityID=c[0].id,this.instanceID=c[0].instance,this.nextActivityType=c[0].modname,"resource"==this.nextActivityType&&(this.nextActivityFormat=c[0].contentsinfo.mimetypes)}}})})})}getCertificate(){window.open(this.cert_url,"_blank")}testCertificate(){this.getCertificateApi.getCertificate(this.courseID,this.userID).subscribe(i=>{i.url?(this.certificateAvailable=!0,this.cert_url=i.url):this.certificateAvailable=!1})}toggleActivityStatus(){this.currentActivity.cmid=this.activityID,this.currentActivity.completed=1,this.updateActivityStatus.updateActivityStatus(this.currentActivity).subscribe(i=>{i.status&&1==i.status&&(this.activityDone=!0,this.testCertificate(),this.activityCompletion.updateActivityStatus(Number(this.activityID)))})}goNextActivity(){-1===this.activityList.findIndex(i=>i.id==this.nextActivityID)&&(this.topicId=this.nextTopicId),"quiz"==this.nextActivityType?this._router.navigate([`course-activity/${this.courseID}/quiz`],{queryParams:{id:this.instanceID,course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"coursefeedback"==this.nextActivityType?this._router.navigate([`course-activity/${this.courseID}/feedback`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"zoom"==this.nextActivityType?this._router.navigate([`course-activity/${this.courseID}/meeting`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"videoplus"===this.nextActivityType?this._router.navigate([`course-activity/${this.courseID}/video-pdf`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"video/mp4"==this.nextActivityFormat||"video/webm"==this.nextActivityFormat||"video/mov"==this.nextActivityFormat?this._router.navigate([`course-activity/${this.courseID}/video`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}}):"application/pdf"==this.nextActivityFormat&&this._router.navigate([`course-activity/${this.courseID}/pdf`],{queryParams:{course:this.courseID,activity:this.nextActivityID,topic:this.topicId}})}goPrevActivity(){-1===this.activityList.findIndex(i=>i.id==this.prevActivityID)&&(this.topicId=this.prevTopicId),"quiz"==this.prevActivityType?this._router.navigate([`course-activity/${this.courseID}/quiz`],{queryParams:{id:this.prevInstanceID,course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):"zoom"==this.prevActivityType?this._router.navigate([`course-activity/${this.courseID}/meeting`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):"videoplus"===this.prevActivityType?this._router.navigate([`course-activity/${this.courseID}/video-pdf`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):"video/mp4"==this.prevActivityFormat||"video/webm"==this.prevActivityFormat||"video/mov"==this.prevActivityFormat?this._router.navigate([`course-activity/${this.courseID}/video`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}}):"application/pdf"==this.prevActivityFormat&&this._router.navigate([`course-activity/${this.courseID}/pdf`],{queryParams:{course:this.courseID,activity:this.prevActivityID,topic:this.topicId}})}saveCurrentActivity(i,o,s,u){const l={type:"pdf",activityId:s,topicId:u};localStorage.setItem(JSON.stringify({userId:i,courseId:o}),JSON.stringify(l))}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(x.H7),t.Y36(p.gz),t.Y36(p.F0),t.Y36(g.G),t.Y36(_),t.Y36(T.o),t.Y36(w.e),t.Y36(C.I),t.Y36(P.B),t.Y36(f.sK))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-pdf-activity"]],decls:4,vars:3,consts:[[1,"min-h-[50vh]"],["class","min-h-screen flex justify-center items-center",4,"ngIf"],["class","h-screen flex justify-center items-center",4,"ngIf"],["class","px-3 h-fit lg:px-0 lg:max-w-4xl xl:max-w-7xl py-5 mx-auto",4,"ngIf"],[1,"min-h-screen","flex","justify-center","items-center"],[1,"loader"],[1,"h-screen","flex","justify-center","items-center"],[1,"text-center","text-vumi-orange","text-2xl","font-bold","lg:text-4xl"],[1,"flex","justify-center","mt-7"],["type","button",1,"button-vumi","text-white","infxs:text-base","sm:text-lg","infxs:w-30","infxs:h-8","sm:w-[140px]","sm:h-[38px]","bg-blue-700","hover:bg-blue-800","focus:outline-none","focus:ring-4","focus:ring-blue-300","font-medium","px-5","py-2.5","text-center","mr-2","mb-2","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800",3,"click"],[1,"px-3","h-fit","lg:px-0","lg:max-w-4xl","xl:max-w-7xl","py-5","mx-auto"],[1,"max-w-[1000px]","mx-auto"],[1,"relative","overflow-hidden","infxs:h-[50vh]","md:h-fit",2,"padding-top","56.25%"],["frameborder","0","scrolling","no","allowfullscreen","",1,"absolute","top-0","left-0","w-full","h-full",3,"src"],[1,"lg:max-w-4xl","xl:max-w-7xl","mb-6","mx-auto"],[1,"infxs:mx-0","xs:mx-15","sm:mx-18","md:mx-20","lg:mx-30","xl:mx-40","gap-2","flex","flex-row","justify-between","lg:mt-4","infxs:mt-4","lg:mb-4","infxs:mb-4"],["style","filter: drop-shadow(0px 4px 4px rgb(35, 6, 1,0.3))","class","button-vumi bg-vumi-orange text-white infxs:text-base sm:text-lg infxs:w-30 infxs:h-8 sm:w-[140px] sm:h-[38px] font-bold capitalize outline-none focus:outline-none mb-1 ease-linear transition-all duration-150","type","button",3,"click",4,"ngIf"],[4,"ngIf"],["style","filter: drop-shadow(0px 4px 4px rgb(35, 6, 1,0.3))","class","button-vumi infxs:w-30 infxs:h-8 sm:w-[140px] sm:h-[38px] bg-vumi-orange text-white infxs:text-base sm:text-lg hover:text-white font-bold capitalize outline-none focus:outline-none mb-1 ease-linear transition-all duration-150","type","button",3,"click",4,"ngIf"],["class","button-vumi infxs:w-30 infxs:h-8 sm:w-[140px] sm:h-[38px] border border-vumi-blue bg-vumi-blue text-white font-bold capitalize outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150","type","button",3,"click",4,"ngIf"],["class","infxs:px-2 button-vumi border border-vumi-blue bg-vumi-blue text-white font-bold capitalize outline-none focus:outline-none mb-1 ease-linear transition-all duration-150","type","button",3,"click",4,"ngIf"],["class","infxs:px-2 infxs:text-base sm:text-lg border border-gray-300 bg-gray-300 text-white font-bold capitalize outline-none focus:outline-none mb-1 ease-linear transition-all duration-150","type","button",3,"disabled",4,"ngIf"],[1,"mb-4"],[1,"text-left","text-black","font-semibold","lg:text-4xl","sm:text-5xl","infxs:text-3xl"],["type","button",1,"button-vumi","bg-vumi-orange","text-white","infxs:text-base","sm:text-lg","infxs:w-30","infxs:h-8","sm:w-[140px]","sm:h-[38px]","font-bold","capitalize","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",2,"filter","drop-shadow(0px 4px 4px rgb(35, 6, 1,0.3))",3,"click"],["aria-hidden","false","aria-label","previous activity icon",1,"text-white","icon-size-7",3,"svgIcon"],["type","button",1,"button-vumi","infxs:w-30","infxs:h-8","sm:w-[140px]","sm:h-[38px]","bg-vumi-orange","text-white","infxs:text-base","sm:text-lg","hover:text-white","font-bold","capitalize","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",2,"filter","drop-shadow(0px 4px 4px rgb(35, 6, 1,0.3))",3,"click"],["type","button",1,"button-vumi","infxs:w-30","infxs:h-8","sm:w-[140px]","sm:h-[38px]","border","border-vumi-blue","bg-vumi-blue","text-white","font-bold","capitalize","outline-none","focus:outline-none","mr-1","mb-1","ease-linear","transition-all","duration-150",3,"click"],["type","button",1,"infxs:px-2","button-vumi","border","border-vumi-blue","bg-vumi-blue","text-white","font-bold","capitalize","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",3,"click"],["type","button",1,"infxs:px-2","infxs:text-base","sm:text-lg","border","border-gray-300","bg-gray-300","text-white","font-bold","capitalize","outline-none","focus:outline-none","mb-1","ease-linear","transition-all","duration-150",3,"disabled"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0),t.YNc(1,Z,2,0,"div",1),t.YNc(2,L,9,6,"div",2),t.YNc(3,J,15,8,"div",3),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.enrolled),t.xp6(1),t.Q6J("ngIf",o.pdfFound&&o.enrolled))},dependencies:[d.O5,y.Hw,f.X$],styles:[".iframe-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:50%;background:lightgrey}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;inset:0}.loader[_ngcontent-%COMP%]{border:14px solid #f3f3f3;border-top:8px solid #0e6eae;border-radius:50%;width:60px;height:60px;animation:spin .8s linear infinite}"]}),e})()}];let M=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,p.Bz.forChild(Y),m.m,y.Ps]}),e})()}}]);